# Команды Telegram бота

## Начало работы

### /start

Приветственное сообщение и краткая информация о боте.

**Использование**:
```
/start
```

**Описание**:
- Показывает приветствие и объяснение возможностей бота
- Важно: бот НЕ ищет информацию в интернете, показывает только данные, добавленные участниками группы
- Отображает версию бота

---

### /help

Справка по командам бота.

**Использование**:
```
/help
/help [команда]
```

**Примеры**:
```
/help
/help add
/help best
```

**Описание**:
- Без параметров показывает список всех команд
- С параметром показывает детальную справку по конкретной команде

---

## Работа с группами

### /creategroup

Создает новую группу пользователей.

**Использование**:
```
/creategroup <название>
```

**Примеры**:
```
/creategroup Семья
/creategroup Друзья
/creategroup Коллеги
```

**Описание**:
- Создает новую группу с указанным названием
- Вы автоматически становитесь участником созданной группы
- Группа необходима для работы с кэшбэками

**Важно**: Перед использованием других команд необходимо создать группу или присоединиться к существующей.

---

### /joingroup

Присоединяет вас к существующей группе.

**Использование**:
```
/joingroup <название>
```

**Примеры**:
```
/joingroup Семья
/joingroup Друзья
```

**Описание**:
- Присоединяет вас к группе, созданной другим пользователем
- Группа должна быть предварительно создана командой `/creategroup`
- Вы можете состоять только в одной группе одновременно

---

### /groupinfo

Показывает информацию о группе и её участниках.

**Использование**:
```
/groupinfo
/groupinfo <название>
```

**Примеры**:
```
/groupinfo
/groupinfo Семья
```

**Описание**:
- Без параметров показывает информацию о вашей текущей группе
- С параметром показывает информацию о указанной группе
- Отображает:
  - Название группы
  - Количество участников
  - Общее количество кэшбэков
  - Список участников с их активностью:
    - Количество добавленных кэшбэков (всего и активных)
    - Дата последней активности

---

## Управление кэшбэками

### /add

Добавляет новое правило кэшбэка.

**Использование**:
```
Отправьте данные через запятую в формате:
Банк, Категория, Процент, Макс.сумма[, Дата окончания]
```

**Примеры**:
```
Тинькофф, Такси, 5%, 3000
Сбер, Супермаркеты, 10, 5000, 31.01.2025
Альфа, Рестораны, 7.5, 4000, 28.02.2025
```

**Формат данных**:
- **Банк** — название банка (например, "Тинькофф", "Сбер", "Альфа")
- **Категория** — категория покупок (например, "Такси", "Рестораны", "Супермаркеты")
- **Процент** — процент кэшбэка (можно указать с % или без)
- **Макс.сумма** — максимальная сумма кэшбэка в рублях
- **Дата окончания** (опционально) — дата окончания действия в формате `DD.MM.YYYY` или `YYYY-MM`

**Особенности**:
- Поддерживается мультистрочный ввод — можно добавить несколько кэшбэков одним сообщением
- Бот автоматически исправляет опечатки в названиях банков и категорий
- Перед сохранением бот показывает распознанные данные для подтверждения
- Если найдены опечатки, бот предложит варианты для исправления

**Процесс добавления**:
1. Отправьте данные в указанном формате
2. Бот проанализирует данные и покажет распознанную информацию
3. Если есть опечатки, бот предложит варианты исправления
4. Подтвердите или исправьте данные
5. Бот сохранит правило в базу данных группы

---

### /list

Показывает список всех кэшбэков группы.

**Использование**:
```
/list
/list all
/list 1-10
/list 1-5,8,10
```

**Примеры**:
```
/list          # Последние 5 записей
/list all      # Все записи
/list 1-10     # Записи с 1 по 10
/list 1-5,8,10 # Записи 1-5, 8 и 10
```

**Описание**:
- По умолчанию показывает последние 5 записей
- `all` — показывает все записи группы
- `1-10` — показывает записи с 1 по 10
- `1-5,8,10` — показывает конкретные записи

**Формат вывода**:
Список отображается в табличном виде с информацией:
- ID правила
- Банк
- Категория
- Процент кэшбэка
- Максимальная сумма
- Пользователь, добавивший правило

---

### /update

Обновляет существующее правило кэшбэка.

**Использование**:
```
/update <ID>
```

**Примеры**:
```
/update 5
/update 12
```

**Описание**:
- Обновляет правило по его ID
- Бот покажет текущую строку в формате для копирования
- Вы можете скопировать, изменить нужные поля и отправить обратно
- Можно обновлять только свои записи

**Процесс обновления**:
1. Отправьте команду `/update <ID>`
2. Бот покажет текущие данные правила
3. Отправьте обновленные данные в том же формате, что и при добавлении
4. Бот обновит правило

---

### /delete

Удаляет правило кэшбэка.

**Использование**:
```
/delete <ID>
```

**Примеры**:
```
/delete 5
/delete 12
```

**Описание**:
- Удаляет правило по его ID
- Можно удалять только свои записи
- Бот запросит подтверждение перед удалением

**Процесс удаления**:
1. Отправьте команду `/delete <ID>`
2. Бот покажет информацию о правиле и запросит подтверждение
3. Подтвердите удаление
4. Бот удалит правило из базы данных

---

## Поиск информации

### /best

Находит лучший кэшбэк для указанной категории.

**Использование**:
```
Просто напишите категорию (без запятых)
```

**Примеры**:
```
Такси
Рестораны
Супермаркеты
```

**Описание**:
- Ищет все кэшбэки по указанной категории
- Показывает их, отсортированными по убыванию процента
- Если точной категории нет, ищет правило "Все покупки"
- Бот умеет исправлять опечатки и предлагает похожие категории

**Формат вывода**:
Показывает список кэшбэков с информацией:
- Банк
- Категория
- Процент кэшбэка
- Максимальная сумма
- Пользователь, добавивший правило

---

### /bankinfo

Показывает все активные кэшбэки указанного банка.

**Использование**:
```
/bankinfo <название банка>
```

**Примеры**:
```
/bankinfo Тинькофф
/bankinfo Сбер
/bankinfo Альфа
```

**Описание**:
- Показывает все активные (не истекшие) кэшбэки указанного банка в вашей группе
- Бот автоматически исправляет опечатки в названии банка
- Если банк не найден, бот предложит похожие варианты

---

### /categorylist

Показывает список всех активных категорий в группе.

**Использование**:
```
/categorylist
```

**Описание**:
- Показывает все уникальные категории, по которым есть активный (не истекший) кэшбэк в группе
- Помогает узнать, по каким категориям есть кэшбэки

---

### /banklist

Показывает список всех активных банков в группе.

**Использование**:
```
/banklist
```

**Описание**:
- Показывает все уникальные банки, по которым есть активный (не истекший) кэшбэк в группе
- Помогает узнать, по каким банкам есть кэшбэки

---

## Работа с пользователями

### /userinfo

Показывает все кэшбэки указанного пользователя.

**Использование**:
```
/userinfo
/userinfo <ID>
```

**Примеры**:
```
/userinfo
/userinfo 123456789
```

**Описание**:
- Без параметров показывает ваши собственные кэшбэки
- С параметром показывает кэшбэки указанного пользователя по его ID
- ID пользователя можно узнать из команды `/userlist`

---

### /userlist

Показывает список всех участников группы.

**Использование**:
```
/userlist
/userlist 1-10
/userlist 1,3,5
```

**Примеры**:
```
/userlist        # Все пользователи
/userlist 1-10   # С 1 по 10
/userlist 1,3,5  # Пользователи 1, 3 и 5
```

**Описание**:
- Показывает всех пользователей группы в табличном виде
- Поддерживает пагинацию для удобного просмотра
- Отображает ID пользователя, имя и количество добавленных кэшбэков

---

## Другие команды

### /cancel

Отменяет текущую операцию.

**Использование**:
```
/cancel
```

**Описание**:
- Отменяет текущую операцию и сбрасывает состояние диалога
- Полезно, если вы начали добавлять кэшбэк, но передумали

---

## Клавиатура бота

Бот предоставляет удобную клавиатуру с кнопками для быстрого доступа к командам:

- **Навигация**: кнопки "◀️ Назад" и "▶️ Вперед" для переключения между страницами команд
- **Быстрый доступ**: основные команды доступны через кнопки

Клавиатура автоматически обновляется в зависимости от контекста диалога.

---

## Форматы данных

### Формат даты

Бот понимает несколько форматов даты:
- `DD.MM.YYYY` (например, `31.01.2025`)
- `YYYY-MM` (например, `2024-12`)
- `YYYY-MM-DD` (например, `2024-12-31`)

### Формат процента

Процент кэшбэка можно указывать:
- С символом `%`: `5%`, `10%`
- Без символа: `5`, `10`
- С десятичными: `5.5`, `7.5`

### Формат суммы

Максимальная сумма указывается в рублях:
- Без символа валюты: `3000`, `5000`
- С десятичными: `3000.50`

---

## Обработка опечаток

Бот использует fuzzy-поиск для исправления опечаток в:
- Названиях банков
- Категориях покупок
- Названиях групп

Если бот находит опечатки, он предложит варианты для исправления с указанием коэффициента схожести.

---

## Примеры использования

### Сценарий 1: Создание группы и добавление первого кэшбэка

```
1. /creategroup Семья
2. Тинькофф, Такси, 5%, 3000
3. Подтверждение данных
4. ✅ Кэшбэк сохранен!
```

### Сценарий 2: Поиск лучшего кэшбэка

```
1. Такси
2. Бот показывает список кэшбэков по категории "Такси", отсортированных по проценту
```

### Сценарий 3: Обновление кэшбэка

```
1. /update 5
2. Бот показывает текущие данные
3. Сбер, Супермаркеты, 10, 5000
4. ✅ Кэшбэк обновлен!
```

### Сценарий 4: Просмотр информации о группе

```
1. /groupinfo
2. Бот показывает:
   - Название группы: Семья
   - Участников: 3
   - Всего кэшбэков: 15
   - Список участников с их активностью
```

---

## Важные замечания

⚠️ **Бот НЕ ищет информацию в интернете**

Бот показывает только кэшбэки, добавленные участниками вашей группы. Если в группе нет данных, бот ничего не найдет.

⚠️ **Необходимость группы**

Перед использованием команд управления кэшбэками необходимо создать группу или присоединиться к существующей.

⚠️ **Права доступа**

- Вы можете обновлять и удалять только свои записи
- Все участники группы видят все кэшбэки группы
- Группа видит только свои данные

---

## Следующие шаги

- [API Справочник](04-api-reference.md) — работа с API напрямую
- [Установка](03-installation.md) — настройка бота
- [Разработка](08-development.md) — разработка новых функций

