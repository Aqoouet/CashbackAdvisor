# üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Open Cashback Advisor

## –û–±–∑–æ—Ä

Open Cashback Advisor –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (Clean Architecture) —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–µ–≤ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–æ–µ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         HTTP Handlers Layer          ‚îÇ
‚îÇ      (internal/handlers)             ‚îÇ
‚îÇ   - –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤          ‚îÇ
‚îÇ   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö         ‚îÇ
‚îÇ   - –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Service Layer                ‚îÇ
‚îÇ      (internal/service)              ‚îÇ
‚îÇ   - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞                    ‚îÇ
‚îÇ   - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π             ‚îÇ
‚îÇ   - –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Repository Layer             ‚îÇ
‚îÇ      (internal/database)             ‚îÇ
‚îÇ   - –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö            ‚îÇ
‚îÇ   - SQL –∑–∞–ø—Ä–æ—Å—ã                      ‚îÇ
‚îÇ   - Fuzzy-–ø–æ–∏—Å–∫                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         PostgreSQL Database          ‚îÇ
‚îÇ   - –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö                  ‚îÇ
‚îÇ   - pg_trgm –¥–ª—è fuzzy-–ø–æ–∏—Å–∫–∞         ‚îÇ
‚îÇ   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Models (`internal/models`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö
- DTO (Data Transfer Objects)
- –ó–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã API

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã:**
- `CashbackRule` - –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª–∞ –∫—ç—à–±—ç–∫–∞
- `CreateCashbackRequest` - –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ
- `SuggestRequest/Response` - –∞–Ω–∞–ª–∏–∑ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- `FuzzySuggestion` - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### 2. Validator (`internal/validator`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `ValidateMonthYear()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ YYYY-MM
- `ValidateCashbackPercent()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ (0-100)
- `ValidateMaxAmount()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–º–º—ã (‚â•0)
- `ValidateTextField()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π
- `RoundToTwoDecimals()` - –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 2 –∑–Ω–∞–∫–æ–≤

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|------|-----|-------------|
| month_year | string | –§–æ—Ä–º–∞—Ç YYYY-MM, –≤–∞–ª–∏–¥–Ω–∞—è –¥–∞—Ç–∞ |
| cashback_percent | float64 | 0.00 ‚â§ x ‚â§ 100.00 |
| max_amount | float64 | x ‚â• 0.00 |
| –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è | string | 1-500 —Å–∏–º–≤–æ–ª–æ–≤ |

### 3. Database (`internal/database`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î
- –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- Health checks

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—É–ª–∞:**
- MaxConns: 25
- MinConns: 5
- MaxConnLifetime: 1 —á–∞—Å
- MaxConnIdleTime: 30 –º–∏–Ω—É—Ç
- HealthCheckPeriod: 1 –º–∏–Ω—É—Ç–∞

### 4. Repository (`internal/database/repository.go`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- Fuzzy-–ø–æ–∏—Å–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pg_trgm
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

#### CRUD:
- `Create()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞
- `GetByID()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `Update()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞)
- `Delete()` - —É–¥–∞–ª–µ–Ω–∏–µ
- `List()` - —Å–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

#### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ:
- `GetBestCashback()` - –ª—É—á—à–∏–π –∫—ç—à–±—ç–∫ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- `FuzzySearchGroupName()` - –ø–æ–∏—Å–∫ –ø–æ –≥—Ä—É–ø–ø–∞–º
- `FuzzySearchCategory()` - –ø–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- `FuzzySearchBankName()` - –ø–æ–∏—Å–∫ –ø–æ –±–∞–Ω–∫–∞–º
- `FuzzySearchUserDisplayName()` - –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**Fuzzy-–ø–æ–∏—Å–∫:**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL —Ñ—É–Ω–∫—Ü–∏—é `similarity()` –∏–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è pg_trgm:

```sql
SELECT DISTINCT field, similarity(field, $1) as sim
FROM cashback_rules
WHERE similarity(field, $1) >= $2
ORDER BY sim DESC
LIMIT $3
```

**–ü–æ—Ä–æ–≥–∏ —Å—Ö–æ–∂–µ—Å—Ç–∏:**
- group_name: 0.6
- category: 0.6
- bank_name: 0.65
- user_display_name: 0.7

### 5. Service (`internal/service`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `Suggest()` - –∞–Ω–∞–ª–∏–∑ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- `CreateCashback()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- `UpdateCashback()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- `DeleteCashback()` - —É–¥–∞–ª–µ–Ω–∏–µ
- `ListCashback()` - —Å–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- `GetBestCashback()` - –ª—É—á—à–∏–π –∫—ç—à–±—ç–∫

**–ü—Ä–æ—Ü–µ—Å—Å Suggest:**
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
2. –ï—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞ - –≤–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–æ–∫
3. Fuzzy-–ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º 4 —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º
4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏

### 6. Handlers (`internal/handlers`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- HTTP –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON
- HTTP –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| POST | /api/v1/cashback/suggest | –ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è |
| POST | /api/v1/cashback | –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ |
| GET | /api/v1/cashback | –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª |
| GET | /api/v1/cashback/best | –õ—É—á—à–∏–π –∫—ç—à–±—ç–∫ |
| GET | /api/v1/cashback/{id} | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ |
| PUT | /api/v1/cashback/{id} | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ |
| DELETE | /api/v1/cashback/{id} | –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ |
| GET | /health | Health check |

### 7. Config (`internal/config`)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Database: host, port, user, password, dbname, sslmode
- Server: host, port

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞

```sql
CREATE TABLE cashback_rules (
    id BIGSERIAL PRIMARY KEY,
    group_name TEXT NOT NULL,
    category TEXT NOT NULL,
    bank_name TEXT NOT NULL,
    user_id TEXT NOT NULL,
    user_display_name TEXT NOT NULL,
    month_year DATE NOT NULL,
    cashback_percent NUMERIC(5,2) NOT NULL CHECK (0 <= x <= 100),
    max_amount NUMERIC(10,2) NOT NULL CHECK (x >= 0),
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
```

### –ò–Ω–¥–µ–∫—Å—ã

**Trigram –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è fuzzy-–ø–æ–∏—Å–∫–∞:**
```sql
CREATE INDEX idx_group_trgm ON cashback_rules USING GIN (group_name gin_trgm_ops);
CREATE INDEX idx_category_trgm ON cashback_rules USING GIN (category gin_trgm_ops);
CREATE INDEX idx_bank_trgm ON cashback_rules USING GIN (bank_name gin_trgm_ops);
CREATE INDEX idx_user_name_trgm ON cashback_rules USING GIN (user_display_name gin_trgm_ops);
```

**–°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
```sql
CREATE INDEX idx_group_month_cat ON cashback_rules (group_name, month_year, category);
```

**–ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
```sql
CREATE INDEX idx_user_id ON cashback_rules (user_id);
```

### –¢—Ä–∏–≥–≥–µ—Ä—ã

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ updated_at:**
```sql
CREATE TRIGGER update_cashback_rules_updated_at
    BEFORE UPDATE ON cashback_rules
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();
```

## Middleware

### Chi Router Middleware

1. **RequestID** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
2. **RealIP** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ IP –∫–ª–∏–µ–Ω—Ç–∞
3. **Logger** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **Recoverer** - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–∞–Ω–∏–∫
5. **Timeout** - —Ç–∞–π–º–∞—É—Ç 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
6. **CORS** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ CORS

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –£—Ä–æ–≤–Ω–∏ –æ—à–∏–±–æ–∫

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è (400 Bad Request)**
   - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö
   - –ù–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

2. **Not Found (404)**
   - –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
   - –ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

3. **Internal Server Error (500)**
   - –û—à–∏–±–∫–∏ –ë–î
   - –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

```json
{
  "error": "–û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ",
  "details": [
    "–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ 1",
    "–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ 2"
  ]
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### SQL Injection

–ó–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
```go
query := "SELECT * FROM cashback_rules WHERE id = $1"
db.QueryRow(ctx, query, id)
```

### Concurrency

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ context –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π** - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
2. **GIN –∏–Ω–¥–µ–∫—Å—ã** - –±—ã—Å—Ç—Ä—ã–π fuzzy-–ø–æ–∏—Å–∫
3. **–°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤
5. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ

- Stateless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- –û–±—â–∞—è –ë–î –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - Redis –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. **–ú–µ—Ç—Ä–∏–∫–∏** - Prometheus –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. **–¢—Ä–µ–π—Å–∏–Ω–≥** - OpenTelemetry –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **Rate Limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
5. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - JWT —Ç–æ–∫–µ–Ω—ã
6. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π
7. **GraphQL** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
8. **WebSocket** - real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **Unit —Ç–µ—Å—Ç—ã** - –≤–∞–ª–∏–¥–∞—Ü–∏—è, —É—Ç–∏–ª–∏—Ç—ã
2. **Integration —Ç–µ—Å—Ç—ã** - —Ä–∞–±–æ—Ç–∞ —Å –ë–î
3. **E2E —Ç–µ—Å—Ç—ã** - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª API

### –ü–æ–∫—Ä—ã—Ç–∏–µ

–¶–µ–ª—å: >80% –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –û–ø—Ü–∏–∏

1. **Docker Compose** - –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
2. **Kubernetes** - –ø—Ä–æ–¥–∞–∫—à–µ–Ω
3. **Cloud Services** - AWS/GCP/Azure

### CI/CD

1. –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç—ã
2. Docker –æ–±—Ä–∞–∑
3. –î–µ–ø–ª–æ–π –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
4. Health checks
5. Rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

